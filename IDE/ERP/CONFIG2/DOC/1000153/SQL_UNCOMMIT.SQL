-- PEAKTOP:IDE/ERP/CONFIG2/DOC/1000153/SQL_UNCOMMIT.SQL
EXECUTE BLOCK(
  Q_J_ID TYPE OF COLUMN TABL$J_4.ID = ?J_ID
)AS
  DECLARE VARIABLE P_J_ID2          TYPE OF COLUMN TABL$J_4.ID;
BEGIN
  FOR
    SELECT DISTINCT J.ID
    FROM   TABL$J_CHILDS JC, TABL$J_4 J
    WHERE  (JC.J_ID   = :Q_J_ID)
      AND  (J.ID      = JC.J_CHILD_ID)
      AND  (J.TYPE_ID = 1000028 )
    INTO   :P_J_ID2
  DO
    BEGIN
    
    UPDATE TABL$J_4 J1 SET 
      J1.FLAG_COMMIT = 0 
    WHERE (J1.ID = :P_J_ID2);
    
    DELETE FROM TABL$J_4 J4
    WHERE  (J4.ID = :P_J_ID2);
    
    END

  UPDATE TABL$J_4 J SET J.FLAG_COMMIT = 0 WHERE (J.ID = :Q_J_ID);
END
