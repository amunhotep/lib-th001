EXECUTE BLOCK RETURNS(
  ID                   TYPE OF COLUMN TABL$R_FIRMS.ID
 ,NAME                 TYPE OF COLUMN TABL$R_FIRMS.NAME
 ,PATH_LOGO            TYPE OF COLUMN TABL$R_FIRMS.PATH_LOGO
 ,WRK_ID_CEO           TYPE OF COLUMN TABL$R_FIRMS.ID
 ,WRK_ID_SEO           TYPE OF COLUMN TABL$R_FIRMS.ID
 ,WRK_ID_BUH           TYPE OF COLUMN TABL$R_FIRMS.ID
 ,WRK_NAME_CEO         TYPE OF COLUMN TABL$R_WRK.NAME
 ,WRK_NAME_SEO         TYPE OF COLUMN TABL$R_WRK.NAME
 ,WRK_NAME_BUH         TYPE OF COLUMN TABL$R_WRK.NAME
 ,ENT_CS_ID            TYPE OF COLUMN TABL$R_CS.ID
 ,ENT_CS_NAME          TYPE OF COLUMN TABL$R_CS.NAME
 ,ENT_CS_NAME2         TYPE OF COLUMN TABL$R_CS.NAME2
 ,ENT_CS_FLAG_DELETE   TYPE OF COLUMN TABL$R_CS.FLAG_DELETE
 ,ENT_CS_INN           TYPE OF COLUMN TABL$R_CS.INN
 ,ENT_CS_NDS_PAYED     TYPE OF COLUMN TABL$R_CS.NDS_PAYED
 ,ENT_CS_NDS_CODE      TYPE OF COLUMN TABL$R_CS.NDS_CODE
 ,ENT_CS_GUID          TYPE OF COLUMN TABL$R_CS.GUID
 ,ENT_CS_COMENT        TYPE OF COLUMN TABL$R_CS.COMENT
 ,ENT_CS_ADDR_ID       TYPE OF COLUMN VIEW$R_CS_ADDR.ID
 ,ENT_CS_ADDR_NAME     TYPE OF COLUMN TABL$R_CS.COMENT
 ,ENT_CS_ADDR_NAME_2   TYPE OF COLUMN TABL$R_CS.COMENT
 ,BANK_ID              TYPE OF COLUMN VIEW$R_CS_BANK.ID
 ,BANK_RS              TYPE OF COLUMN VIEW$R_CS_BANK.NAME
 ,BANK_MFO             TYPE OF COLUMN TABL$R_BANKS.MFO
 ,BANK_EDRPOU          TYPE OF COLUMN TABL$R_BANKS.EDRPOU
 ,BANK_NAME            TYPE OF COLUMN TABL$R_BANKS.NAME
 ,BANK_ADDRESS         TYPE OF COLUMN TABL$R_BANKS.ADDRESS
 ,FILIAL_ID            TYPE OF COLUMN TABL$R_FILIALS.ID
 ,FILIAL_NAME          TYPE OF COLUMN TABL$R_FILIALS.NAME
 ,FILIAL_FLAG_DELETE   TYPE OF COLUMN TABL$R_FILIALS.FLAG_DELETE
 ,FILIAL_PREFIX        TYPE OF COLUMN TABL$R_FILIALS.PREFIX
 ,FILIAL_GUID          TYPE OF COLUMN TABL$R_FILIALS.GUID
 ,FILIAL_DATABASE_NAME TYPE OF COLUMN TABL$R_FILIALS.DATABASE_NAME
 ,FILIAL_ADDRESS       TYPE OF COLUMN TABL$R_FILIALS.ADDRESS
 ,FILIAL_PHONE         TYPE OF COLUMN TABL$R_FILIALS.PHONE
 ,FILIAL_GRAPHIK       TYPE OF COLUMN TABL$R_FILIALS.GRAPHIK
)AS
  DECLARE VARIABLE P_COUNTRY_NAME   TYPE OF COLUMN TABL$R_COUNTRIES.NAME;
  DECLARE VARIABLE P_REGION_NAME    TYPE OF COLUMN TABL$R_REGIONS.NAME;
  DECLARE VARIABLE P_ADDRESS_ID     TYPE OF COLUMN VIEW$R_CS_ADDR.ID;
  DECLARE VARIABLE P_ADDRESS_ZIP    TYPE OF COLUMN VIEW$R_CS_ADDR.ZIP;
  DECLARE VARIABLE P_ADDRESS_PHONES DOMN$BLOB_TEXT;
BEGIN
  ID = 9;
  SELECT FIRST 1 FL.ID FROM TABL$R_FILIALS FL
  WHERE  (FL.GUID = (SELECT FIRST 1 P.GUID FROM PROC$_DB_GUID P))
  INTO   :FILIAL_ID;

  SELECT FIRST 1 FF.NAME, FF.PATH_LOGO
        ,CS.ID, CS.NAME, CS.NAME2, CS.FLAG_DELETE
        ,CS.INN, CS.NDS_PAYED, CS.NDS_CODE, CS.GUID, CS.COMENT
        ,CS.WRK_ID_DIR, CS.WRK_ID_DIR, CS.WRK_ID_BUH
  FROM   TABL$R_FIRMS FF, TABL$R_CS CS
  WHERE  (FF.ID = :ID)
    AND  (CS.ID = FF.CS_ID)
  INTO   :NAME, :PATH_LOGO
        ,:ENT_CS_ID, :ENT_CS_NAME, :ENT_CS_NAME2, :ENT_CS_FLAG_DELETE, :ENT_CS_INN
        ,:ENT_CS_NDS_PAYED, :ENT_CS_NDS_CODE, :ENT_CS_GUID, :ENT_CS_COMENT
        ,:WRK_ID_CEO, :WRK_ID_SEO, :WRK_ID_BUH
        ;

  SELECT FIRST 1 COALESCE(W.NAME,'') FROM TABL$R_WRK W WHERE (W.ID = :WRK_ID_CEO) INTO :WRK_NAME_CEO;
  SELECT FIRST 1 COALESCE(W.NAME,'') FROM TABL$R_WRK W WHERE (W.ID = :WRK_ID_SEO) INTO :WRK_NAME_SEO;
  SELECT FIRST 1 COALESCE(W.NAME,'') FROM TABL$R_WRK W WHERE (W.ID = :WRK_ID_BUH) INTO :WRK_NAME_BUH;

  SELECT FIRST 1 CSA.ID
  FROM   VIEW$R_CS_ADDR CSA
  WHERE  (CSA.CS_ID = :ENT_CS_ID)
    AND  (CSA.FLAG_JURIDICAL = 1)
  INTO   :ENT_CS_ADDR_ID;

  SELECT FIRST 1 CSA.ZIP, CSA.NAME, CNTR.NAME, REGN.NAME
  FROM   VIEW$R_CS_ADDR CSA, TABL$R_COUNTRIES CNTR, TABL$R_REGIONS REGN
  WHERE  (CSA.ID = :ENT_CS_ADDR_ID)
    AND  (CNTR.ID = CSA.COUNTRY_ID)
    AND  (REGN.ID = CSA.REGION_ID)
  INTO   :P_ADDRESS_ZIP, :ENT_CS_ADDR_NAME_2, :P_COUNTRY_NAME, :P_REGION_NAME;
  IF(:ENT_CS_ADDR_NAME_2 IS NULL)THEN ENT_CS_ADDR_NAME_2 = '';
  SELECT LIST(P.NAME, '; ') FROM VIEW$R_CS_PHONES P WHERE (P.CS_ID = :ENT_CS_ID) INTO :P_ADDRESS_PHONES;
  IF(:P_ADDRESS_PHONES IS NULL) THEN P_ADDRESS_PHONES = '';

  ENT_CS_ADDR_NAME = :P_ADDRESS_ZIP||', '||:P_COUNTRY_NAME||', '||:P_REGION_NAME||', '||:ENT_CS_ADDR_NAME_2||'.  T:'||:P_ADDRESS_PHONES;

  SELECT FIRST 1 B.ID
  FROM   VIEW$R_CS_BANK B
  WHERE  (B.CS_ID      = :ENT_CS_ID)
    AND  (B.FLAG_MAIN  = 1)
    AND  (B.COUNTRY_ID = 1000071)
  INTO   :BANK_ID;

  IF(:BANK_ID IS NULL)THEN
    SELECT FIRST 1 B.ID
    FROM   VIEW$R_CS_BANK B
    WHERE  (B.CS_ID = :ENT_CS_ID)
      AND  (B.COUNTRY_ID = 1000071)
    INTO   :BANK_ID;

  SELECT FIRST 1 B1.NAME, BB.MFO, BB.EDRPOU, BB.NAME, BB.ADDRESS
  FROM   VIEW$R_CS_BANK B1, TABL$R_BANKS BB
  WHERE  (B1.ID = :BANK_ID)
    AND  (BB.ID = B1.BANK_ID)
  INTO   :BANK_RS, :BANK_MFO, :BANK_EDRPOU, :BANK_NAME, :BANK_ADDRESS;

  SELECT FIRST 1 FL.NAME, FL.FLAG_DELETE, FL.PREFIX, FL.GUID,
         FL.DATABASE_NAME, FL.ADDRESS, FL.PHONE, FL.GRAPHIK
  FROM   TABL$R_FILIALS FL
  WHERE  (FL.ID = :FILIAL_ID)
  INTO   :FILIAL_NAME, :FILIAL_FLAG_DELETE, :FILIAL_PREFIX, :FILIAL_GUID,
         :FILIAL_DATABASE_NAME, :FILIAL_ADDRESS, :FILIAL_PHONE, :FILIAL_GRAPHIK;

  SUSPEND;
END
