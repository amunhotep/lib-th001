SELECT R0000.ID AS DS$ID 
      ,R0000.ID AS J_ID 
      ,R0000.FLAG_DELETE
      ,R0000.FLAG_COMMIT
      ,R0000.FLAG_LOCK
      ,R0000.ID
      ,R0000.TYPE_ID, TBD01.NAME AS TYPE_ID_
      ,R0000.DOCNUMBER
      ,R0000.DOCNUMBERSTR
      ,R0000.DOCNUMBERIN
      ,R0001.CS_ID, RCS.NAME AS CS_ID_, RCS.NAME2 AS CS_NAME, RCS.INN AS CS_INN, RCS.EDRPOU AS CS_EDRPOU, RCS.CERTIFICATE AS CS_CERTIFICATE
      ,RCS.NDS_PAYED AS CS_NDS_PAYED, RCS.NDS_CODE AS CS_NDS_CODE 
      ,(SELECT FIRST 1 T0007.ADDRESS_NAME_FULL||'; тел.:'||COALESCE(T0007.ADDRESS_PHONES,'') FROM PROC$R_ADDRESS_GET_CSJURIDICAL(R0001.CS_ID) T0007) AS CS_ADDR_ID_JURIDICAL
      ,R0001.CS_AMOUNT
      ,R0001.FLAG_AMOUNT
      ,R0001.CS_ADDR_ID
      ,RADDR.ADDRESS_NAME_FULL AS CS_ADDR_ID_
      ,RADDR.ADDRESS_GEOORIENT AS CS_ADDR_ID_GEOORIENT
      ,RADDR.ADDRESS_GEONAME   AS CS_ADDR_ID_GEONAME
      ,RADDR.ADDRESS_PHONES    AS CS_ADDR_ID_PHONES
      ,R0001.CS_DOC_ID
      ,(SELECT FIRST 1 T0006.DOC_NAME FROM PROC$R_CS_DOCS_GEITEM(R0001.CS_DOC_ID) T0006) AS CS_DOC_ID_
      ,R0001.CS_POINTS
      ,R0001.CS_POINTSPAYED
      ,R0001.CS_ID_PAY, RCSP.NAME AS CS_ID_PAY_, RCSP.NAME2 AS CS_PAY_NAME, RCSP.INN AS CS_PAY_INN, RCSP.EDRPOU AS CS_PAY_EDRPOU, RCSP.CERTIFICATE AS CS_PAY_CERTIFICATE
      ,RCSP.NDS_PAYED AS CS_PAY_NDS_PAYED, RCSP.NDS_CODE AS CS_PAY_NDS_CODE 
      ,(SELECT FIRST 1 T0009.ADDRESS_NAME_FULL||'; тел.:'||COALESCE(T0009.ADDRESS_PHONES,'') FROM PROC$R_ADDRESS_GET_CSJURIDICAL(R0001.CS_ID_PAY) T0009) AS CS_PAY_ADDR_ID_JURIDICAL
      ,R0001.PLATENO
      ,R0001.GUESTQUANT
      ,R0001.PLACE_ID
      ,(SELECT FIRST 1 T0005.NAME FROM TABL$R_PLACES   T0005 WHERE(T0005.ID = R0001.PLACE_ID)) AS PLACE_ID_
      ,R0001.TO_PLACE_ID
      ,(SELECT FIRST 1 T0006.NAME FROM TABL$R_PLACES   T0006 WHERE(T0006.ID = R0001.TO_PLACE_ID)) AS TO_PLACE_ID_
      ,R0001.WRK_ID
      ,(SELECT FIRST 1 T0007.NAME FROM TABL$R_WRK      T0007 WHERE(T0007.ID = R0001.WRK_ID)) AS WRK_ID_
      ,R0001.TMC_GRID_ID, TGRID.NAME AS TMC_GRID_ID_ , TGRID.FIELD_NAME AS TMC_GRID_FIELD_NAME
      ,R0001.MARKUP, R0001.MARKUPFLAG
      ,R0001.J_ID_PAY
      ,(SELECT FIRST 1 T0008.DOCSTR FROM TABL$J_4 T0008 WHERE (T0008.ID = R0001.J_ID_PAY)) AS J_ID_PAY_
      ,R0001.D_ID_PAY
      ,R0001.FLAG_PAY
      ,R0001.FLAG_CALC
      ,R0000.VALUTE_ID, CNTR.VALUTE_SHORT AS VALUTE_ID_
      ,R0000.DOCSUMVAL
      ,R0000.DOCSUM
      ,R0000.DOCNDP
      ,R0000.DOCSUMWONDP
      ,R0000.NAME
      ,R0000.DATE_COMMIT
      ,R0000.DATE_IN
      ,R0000.FIRM_ID
      ,(SELECT FIRST 1 T0010.NAME FROM TABL$R_FIRMS T0010 WHERE (T0010.ID = R0000.FIRM_ID)) AS FIRM_ID_
      ,R0000.FILIAL_ID
      ,(SELECT FIRST 1 T0011.NAME FROM TABL$R_FILIALS T0011 WHERE (T0011.ID = R0000.FILIAL_ID)) AS FILIAL_ID_
      ,R0000.USER_ID
      ,(SELECT FIRST 1 T0012.ID FROM TABL$_USERS T0012 WHERE (T0012.ID = R0000.USER_ID)) AS USER_ID_
      ,(SELECT FIRST 1 COALESCE(WZZ.NAME, R0000.USER_ID) FROM TABL$R_WRK WZZ WHERE (TRIM(WZZ.USER_NAME) = R0000.USER_ID) ) AS WRK_NAME
      ,R0000.DOCSTR
      ,TBD01.COLOR_FRG
      ,TBD01.COLOR_BGR 
      ,(SELECT FIRST 1 P.TYPELIST FROM PROC$J$TYPELISTROOT(R0000.ID) P ) AS TYPELIST
FROM   TABL$J_4 R0000
         LEFT OUTER JOIN TABL$_TB_DOCS                        TBD01 ON (TBD01.ID   = R0000.TYPE_ID)
         LEFT OUTER JOIN TABL$R_COUNTRIES                     CNTR  ON (CNTR.ID    = R0000.VALUTE_ID)
         LEFT OUTER JOIN TABL$J_1000014                       R0001 ON (R0001.J_ID = R0000.ID)
         LEFT OUTER JOIN TABL$R_CS                            RCS   ON (RCS.ID     = R0001.CS_ID)
         LEFT OUTER JOIN TABL$R_CS                            RCSP  ON (RCS.ID     = R0001.CS_ID_PAY)
         LEFT OUTER JOIN PROC$R_ADDRESS_GET(R0001.CS_ADDR_ID) RADDR ON (1=1)
         LEFT OUTER JOIN TABL$R_TMC_GRID                      TGRID ON (TGRID.ID   = R0001.TMC_GRID_ID)
WHERE (R0000.ID   = ?J_ID) 
