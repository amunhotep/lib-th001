EXECUTE BLOCK(
   Q_DATE_FROM TYPE OF COLUMN TABL$J_4.DATE_COMMIT = ?DATE_FROM
  ,Q_DATE_TO   TYPE OF COLUMN TABL$J_4.DATE_COMMIT = ?DATE_TO
  ,Q_FIRM_IDS  TYPE OF COLUMN TABL$J_4.DOCSTR      = ?FIRM_IDS
)RETURNS(
   DATE_FROM    TYPE OF COLUMN TABL$J_4.DATE_COMMIT
  ,DATE_TO      TYPE OF COLUMN TABL$J_4.DATE_COMMIT
  ,FIRM_IDS     TYPE OF COLUMN TABL$J_4.DOCSTR
  ,PLACE_ID     TYPE OF COLUMN TABL$R_PLACES.ID
  ,PLACE_NAME   TYPE OF COLUMN TABL$R_PLACES.NAME
  ,PLACE_ACC_ID TYPE OF COLUMN TABL$R_PLACES.ACC_ID
  ,FILIAL_ID    TYPE OF COLUMN TABL$R_PLACES.FILIAL_ID
  ,S0600BEG     TYPE OF COLUMN TABL$J_4.DOCSUM, Q0600BEG TYPE OF COLUMN TABL$J_4.DOCSUM, G0600BEG TYPE OF COLUMN TABL$J_4.DOCSUM
  ,S0600DEB     TYPE OF COLUMN TABL$J_4.DOCSUM, Q0600DEB TYPE OF COLUMN TABL$J_4.DOCSUM, G0600DEB TYPE OF COLUMN TABL$J_4.DOCSUM
  ,S0600KRD     TYPE OF COLUMN TABL$J_4.DOCSUM, Q0600KRD TYPE OF COLUMN TABL$J_4.DOCSUM, G0600KRD TYPE OF COLUMN TABL$J_4.DOCSUM
  ,S0600END     TYPE OF COLUMN TABL$J_4.DOCSUM, Q0600END TYPE OF COLUMN TABL$J_4.DOCSUM, G0600END TYPE OF COLUMN TABL$J_4.DOCSUM
  ,S0600DEB_    TYPE OF COLUMN TABL$J_4.DOCSUM
  ,S0600KRD_    TYPE OF COLUMN TABL$J_4.DOCSUM
)AS
BEGIN
  DATE_FROM = :Q_DATE_FROM;
  DATE_TO   = :Q_DATE_TO;
  FIRM_IDS  = :Q_FIRM_IDS;
  FOR
    SELECT PL.ID, PL.NAME, PL.ACC_ID, PL.FILIAL_ID
    FROM   TABL$R_PLACES PL
    WHERE  (PL.ACC_ID = -6)
    INTO   :PLACE_ID, :PLACE_NAME, :PLACE_ACC_ID, :FILIAL_ID
  DO
    BEGIN
    SELECT COALESCE(SUM(SALDOBEGIN_M),0) AS SALDOBEGIN_M
          ,COALESCE(SUM(DEBET_M     ),0) AS DEBET_M
          ,COALESCE(SUM(KREDIT_M    ),0) AS KREDIT_M
          ,COALESCE(SUM(SALDOEND_M  ),0) AS SALDOEND_M
          ,COALESCE(SUM(SALDOBEGIN_Q),0) AS SALDOBEGIN_Q
          ,COALESCE(SUM(DEBET_Q     ),0) AS DEBET_Q
          ,COALESCE(SUM(KREDIT_Q    ),0) AS KREDIT_Q
          ,COALESCE(SUM(SALDOEND_Q  ),0) AS SALDOEND_Q
          ,COALESCE(SUM(SALDOBEGIN_S),0) AS SALDOBEGIN_S
          ,COALESCE(SUM(DEBET_S     ),0) AS DEBET_S
          ,COALESCE(SUM(KREDIT_S    ),0) AS KREDIT_S
          ,COALESCE(SUM(SALDOEND_S  ),0) AS SALDOEND_S
          ,COALESCE(SUM(DEBET_S1    ),0) AS DEBET_S1
          ,COALESCE(SUM(KREDIT_S1   ),0) AS KREDIT_S1
    FROM   PROC$P_TMC_TURNOVER_00004(:Q_DATE_FROM, :Q_DATE_TO, :Q_FIRM_IDS, :PLACE_ID) P
    INTO   :G0600BEG, :G0600DEB, :G0600KRD, :G0600END
          ,:Q0600BEG, :Q0600DEB, :Q0600KRD, :Q0600END
          ,:S0600BEG, :S0600DEB, :S0600KRD, :S0600END
          ,:S0600DEB_, :S0600KRD_;
    IF( (:S0600BEG <> 0) OR (:S0600DEB <> 0)OR (:S0600KRD <> 0) OR (:S0600END <> 0)  OR (:S0600DEB_ <> 0)OR (:S0600KRD_ <> 0) )THEN SUSPEND;
    END
/*
  FOR
    SELECT P.PLACE_ID, P.PLACE_NAME, P.PLACE_ACC_ID, PL.FILIAL_ID
          ,COALESCE(SUM(SALDOBEGIN_M),0) AS SALDOBEGIN_M
          ,COALESCE(SUM(DEBET_M     ),0) AS DEBET_M
          ,COALESCE(SUM(KREDIT_M    ),0) AS KREDIT_M
          ,COALESCE(SUM(SALDOEND_M  ),0) AS SALDOEND_M
          ,COALESCE(SUM(SALDOBEGIN_Q),0) AS SALDOBEGIN_Q
          ,COALESCE(SUM(DEBET_Q     ),0) AS DEBET_Q
          ,COALESCE(SUM(KREDIT_Q    ),0) AS KREDIT_Q
          ,COALESCE(SUM(SALDOEND_Q  ),0) AS SALDOEND_Q
          ,COALESCE(SUM(SALDOBEGIN_S),0) AS SALDOBEGIN_S
          ,COALESCE(SUM(DEBET_S     ),0) AS DEBET_S
          ,COALESCE(SUM(KREDIT_S    ),0) AS KREDIT_S
          ,COALESCE(SUM(SALDOEND_S  ),0) AS SALDOEND_S
          ,COALESCE(SUM(DEBET_S1    ),0) AS DEBET_S1
          ,COALESCE(SUM(KREDIT_S1   ),0) AS KREDIT_S1
    FROM   PROC$P_TMC_TURNOVER_00003(:Q_DATE_FROM, :Q_DATE_TO, :Q_FIRM_IDS) P, TABL$R_PLACES PL
    WHERE (PL.ID = P.PLACE_ID)
      AND (PL.ACC_ID = -6)
    GROUP BY P.PLACE_ID, P.PLACE_NAME, P.PLACE_ACC_ID, PL.FILIAL_ID
    INTO   :PLACE_ID, :PLACE_NAME, :PLACE_ACC_ID, :FILIAL_ID
          ,:G0600BEG, :G0600DEB, :G0600KRD, :G0600END
          ,:Q0600BEG, :Q0600DEB, :Q0600KRD, :Q0600END
          ,:S0600BEG, :S0600DEB, :S0600KRD, :S0600END
          ,:S0600DEB_, :S0600KRD_
  DO
    SUSPEND;
*/    
END
