SELECT R0000.ID AS DS$ID 
      ,R0000.FLAG_DELETE
      ,R0000.FLAG_COMMIT
      ,R0000.FLAG_LOCK
      ,R0000.ID
      ,R0000.TYPE_ID
      ,(SELECT FIRST 1 T0001.NAME FROM TABL$_TB_DOCS T0001 WHERE (T0001.ID = R0000.TYPE_ID)) AS TYPE_ID_
      ,R0000.DOCNUMBER
      ,R0000.DOCNUMBERSTR
      ,R0000.DOCNUMBERIN
      ,R0001.CS_ID
      ,(SELECT FIRST 1 T0002.NAME FROM TABL$R_CS T0002 WHERE (T0002.ID = R0001.CS_ID)) AS CS_ID_
      ,(SELECT FIRST 1 CS1.INN FROM TABL$R_CS CS1 WHERE (CS1.ID = R0001.CS_ID)) AS CS_INN
      ,(SELECT COALESCE(COUNT(REF001.ID),0) FROM TABL$R_CS_PHOTO REF001 WHERE (REF001.CS_ID = R0001.CS_ID)) AS CS_PHOTO
      ,R0001.CS_ADDR_ID
      ,(SELECT FIRST 1 T0003.ADDRESS_NAME_FULL FROM PROC$R_CS_ADDR_GETITEM(R0001.CS_ID, R0001.CS_ADDR_ID) T0003) AS CS_ADDR_ID_
      ,(SELECT FIRST 1 PR1.DOC_NAME FROM PROC$R_CS_DOCS_GEITEM2(R0001.CS_ID) PR1) AS CS_DOC
      ,R0001.STATE_ID
      ,(SELECT FIRST 1 T0004.NAME FROM TABL$R_ENTPS_STATES T0004 WHERE (T0004.ID = R0001.STATE_ID)) AS STATE_ID_
      ,(CASE R0001.STATE_ID
          WHEN 0 THEN IIF(ABS(DATEDIFF(DAY FROM R0001.DATE_LAST TO CURRENT_TIMESTAMP)) > 30, 1, 0)
          WHEN 4 THEN IIF(ABS(DATEDIFF(DAY FROM R0001.DATE_LAST TO CURRENT_TIMESTAMP)) > 30, 1, 0)
          ELSE 0
        END) AS FLAG_WARN
      ,R0001.FLAG_REAL
      ,R0001.TMC_GROUP_ID
      ,(SELECT FIRST 1 T0005.NAME FROM TABL$R_TMC_GROUP T0005 WHERE (T0005.ID = R0001.TMC_GROUP_ID)) AS TMC_GROUP_ID_
      ,R0001.COUNTRIESTP_ID
      ,(SELECT FIRST 1 T0006.NAME FROM TABL$R_COUNTRIESTP T0006 WHERE (T0006.ID = R0001.COUNTRIESTP_ID)) AS COUNTRIESTP_ID_
      ,R0001.DAYSCNT
      ,R0001.DOCSUMCALCBEGIN
      ,R0001.DOCSUMCALC
      ,R0001.DOCSUMLEFT
      ,R0001.SUMDOHOD
      ,(SELECT FIRST 1 PR2.PC FROM PROC$D_1000062_CALC_DOHOD(R0001.J_ID) PR2) AS SUMDOHODPC
      ,R0001.DATE_RETURN
      ,R0001.DATE_LAST
      ,(SELECT CAST(LIST(DISTINCT TG.NAME,'; ') AS DOMN$PSTRING_8192) FROM  TABL$D_1000062 DZ, TABL$R_TMC_GROUP TG WHERE  (DZ.J_ID = R0001.J_ID)AND(TG.ID = DZ.TMC_GROUP_ID)) AS IZDELIYA
      ,(SELECT CAST(SUM(DZ.MASSA_BRUTTO * DZ.QUANT) AS NUMERIC(15,3)) FROM  TABL$D_1000062 DZ WHERE  (DZ.J_ID = R0001.J_ID)) AS MASSA_BRUTTO
      ,(SELECT CAST(SUM(DZ.MASSA_INS * DZ.QUANT) AS NUMERIC(15,3))  FROM  TABL$D_1000062 DZ WHERE  (DZ.J_ID = R0001.J_ID)) AS MASSA_INS
      ,(SELECT CAST(SUM(DZ.MASSA_NETTO * DZ.QUANT) AS NUMERIC(15,3))  FROM  TABL$D_1000062 DZ WHERE  (DZ.J_ID = R0001.J_ID)) AS MASSA_NETTO
      ,R0000.VALUTE_ID
      ,(SELECT FIRST 1 T0007.VALUTE_SHORT FROM TABL$R_COUNTRIES T0007 WHERE (T0007.ID = R0000.VALUTE_ID)) AS VALUTE_ID_
      ,R0000.DOCSUMVAL
      ,R0000.DOCSUM
      ,R0000.NAME
      ,R0000.DATE_COMMIT
      ,(EXTRACT(YEAR FROM R0000.DATE_COMMIT)) AS DATE_COMMIT_YEAR
      ,(EXTRACT(MONTH FROM R0000.DATE_COMMIT)) AS DATE_COMMIT_MONTH
      ,(EXTRACT(DAY FROM R0000.DATE_COMMIT)) AS DATE_COMMIT_DAY
      ,R0000.DATE_IN
      ,R0000.FIRM_ID
      ,(SELECT FIRST 1 T0008.NAME FROM TABL$R_FIRMS T0008 WHERE (T0008.ID = R0000.FIRM_ID)) AS FIRM_ID_
      ,R0000.FILIAL_ID
      ,(SELECT FIRST 1 T0009.NAME FROM TABL$R_FILIALS T0009 WHERE (T0009.ID = R0000.FILIAL_ID)) AS FILIAL_ID_
      ,R0000.USER_ID
      ,(SELECT FIRST 1 T0010.ID FROM TABL$_USERS T0010 WHERE (T0010.ID = R0000.USER_ID)) AS USER_ID_
      ,(SELECT FIRST 1 COALESCE(WZZ.NAME, R0000.USER_ID) FROM TABL$R_WRK WZZ WHERE (TRIM(WZZ.USER_NAME) = R0000.USER_ID) ) AS WRK_NAME
      ,R0000.DOCSTR
      ,(SELECT FIRST 1 TBD01.COLOR_FRG FROM TABL$_TB_DOCS TBD01 WHERE (TBD01.ID = R0000.TYPE_ID)) AS COLOR_FRG
      ,(SELECT FIRST 1 TBD01.COLOR_BGR FROM TABL$_TB_DOCS TBD01 WHERE (TBD01.ID = R0000.TYPE_ID)) AS COLOR_BGR 
FROM  <TABLE_NAME>  GTT01, TABL$J_4 R0000, TABL$J_1000062 R0001
WHERE (R0000.DOCNUMBERSTR = GTT01.DOCNUMBERSTR)
  AND (R0001.J_ID = R0000.ID)
ORDER BY R0000.ID ASCENDING
