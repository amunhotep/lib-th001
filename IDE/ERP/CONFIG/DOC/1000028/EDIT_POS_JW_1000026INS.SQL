EXECUTE BLOCK (
  Q_PARENT_DOC_ID TYPE OF COLUMN TABL$J_4.ID = ?ID
)RETURNS(
  J_ID       TYPE OF COLUMN TABL$J_4.ID
 ,DOCTYPE_ID TYPE OF COLUMN TABL$J_4.TYPE_ID
)AS
  DECLARE VARIABLE P_FIRM_ID  TYPE OF COLUMN TABL$J_4.FIRM_ID;
  DECLARE VARIABLE P_CS_ID    TYPE OF COLUMN TABL$R_CS.ID;
  DECLARE VARIABLE P_PLACE_ID TYPE OF COLUMN TABL$J_1000014.PLACE_ID;
BEGIN
  DOCTYPE_ID = 1000026;

  SELECT FIRST 1 J.FIRM_ID, J14.CS_ID, J14.PLACE_ID
  FROM   TABL$J_4 J, TABL$J_1000014 J14
  WHERE  (J.ID = :Q_PARENT_DOC_ID)
    AND  (J14.J_ID = J.ID)
  INTO   :P_FIRM_ID, :P_CS_ID, :P_PLACE_ID;

  SELECT FIRST 1 P.J_ID FROM PROC$J_INS_4(:P_FIRM_ID, :DOCTYPE_ID, :Q_PARENT_DOC_ID) P INTO :J_ID;

  INSERT INTO TABL$J_1000014 (J_ID, CS_ID, CS_ADDR_ID, PLACE_ID, TAX_ID, TO_PLACE_ID, WRK_ID, TMC_GRID_ID)
  VALUES (:J_ID, :P_CS_ID, 0, :P_PLACE_ID, 1000008, 0, 0, 0);
  
  UPDATE TABL$J_4 J SET J.NAME = 'Обмен драгоценных металлов' WHERE (J.ID = :J_ID);

  SUSPEND;
END
