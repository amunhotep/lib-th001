{$DEFINE PEAKTOP:IDE/ERP/DBO/DBGRID/EXPORT/EXCEL.PS}
{$IFNDEF PEAKTOP:GLOBAL_VARIABLES.INC}                {$I PEAKTOP:GLOBAL_VARIABLES.INC}{$ENDIF}
{$IFNDEF PEAKTOP:GLOBAL_OBJECTS.INC}                  {$I PEAKTOP:GLOBAL_OBJECTS.INC}  {$ENDIF}
{$IFNDEF PEAKTOP:IDE/ERP/DBO/DBGRID/EXPORT/CONST.INC} {$I ./CONST.INC}                 {$ENDIF}
{$IFNDEF PEAKTOP:IDE/ERP/DBO/DBGRID/EXPORT/HTML.INC}  {$I ./HTML.INC}                  {$ENDIF}
var
  lkIndx :Integer;
  lkOBJ  :TObject;
begin
  if not GlobalObjects_Exists(ERP_DBGRID_EXPORT_GLOBALOBJECT_NAME, lkIndx)then exit;
  lkOBJ := GlobalObjects_Find(ERP_DBGRID_EXPORT_GLOBALOBJECT_NAME);
  if(lkOBJ = nil)then exit;
  if ObjectInheritsFrom(lkOBJ, 'TDBGridEh') then
    ERP_DBGridEh_ExportToHTML(TDBGridEh(lkOBJ)
      ,GetGlobalVariable(ERP_DBGRID_EXPORT_GLOBALVARIABLE_FILENAME)
      ,GetGlobalVariable(ERP_DBGRID_EXPORT_GLOBALVARIABLE_ENTNAME)
      ,GetGlobalVariable(ERP_DBGRID_EXPORT_GLOBALVARIABLE_ENTADDR)
      ,GetGlobalVariable(ERP_DBGRID_EXPORT_GLOBALVARIABLE_CAPTION)
      ,GetGlobalVariable(ERP_DBGRID_EXPORT_GLOBALVARIABLE_FILTER )
    );
  GlobalObjects_Delete(ERP_DBGRID_EXPORT_GLOBALOBJECT_NAME);
  SetGlobalVariable(ERP_DBGRID_EXPORT_GLOBALVARIABLE_FILENAME,'');
  SetGlobalVariable(ERP_DBGRID_EXPORT_GLOBALVARIABLE_ENTNAME ,'');
  SetGlobalVariable(ERP_DBGRID_EXPORT_GLOBALVARIABLE_ENTADDR ,'');
  SetGlobalVariable(ERP_DBGRID_EXPORT_GLOBALVARIABLE_CAPTION ,'');
  SetGlobalVariable(ERP_DBGRID_EXPORT_GLOBALVARIABLE_FILTER  ,'');
end.
