EXECUTE BLOCK
AS
  DECLARE VARIABLE P_OBJ_ID      TYPE OF COLUMN TABL$_TB_DOCSRPT.OBJ_ID;
  DECLARE VARIABLE P_ID          TYPE OF COLUMN TABL$_TB_DOCSRPT.ID;
  DECLARE VARIABLE P_NAME        TYPE OF COLUMN TABL$_TB_DOCSRPT.NAME;
  DECLARE VARIABLE P_NAME2       TYPE OF COLUMN TABL$_TB_DOCSRPT.NAME;
  DECLARE VARIABLE P_FLAG_DELETE TYPE OF COLUMN TABL$_TB_DOCSRPT.FLAG_DELETE;
  DECLARE VARIABLE P_ORDERID     TYPE OF COLUMN TABL$_TB_DOCSRPT.ORDERID;
  DECLARE VARIABLE P_SUBTYPE     TYPE OF COLUMN TABL$_TB_DOCSRPT.SUBTYPE;
  DECLARE VARIABLE P_PATH        TYPE OF COLUMN TABL$_TB_DOCSRPT.PATH;
  DECLARE VARIABLE P_DESCR       TYPE OF COLUMN TABL$_TB_DOCSRPT.DESCR;
BEGIN
  P_FLAG_DELETE = 0;
  FOR
    SELECT TMP.OBJ_ID, TMP.NAME, TMP.NAME2
    FROM   (WITH RECURSIVE TTT AS(
              SELECT TT1.ROOT_ID, TT1.ID, TT1.PARENT_ID, TT1.NAME, TT1.NAME2, CAST('+---' AS VARCHAR(255)) AS INDENT
              FROM TABL$_TB_TYPES TT1 WHERE (TT1.ID = 4)
              UNION ALL
              SELECT TT2.ROOT_ID, TT2.ID, TT2.PARENT_ID, TT2.NAME, TT2.NAME2, CAST('    '||TT3.INDENT AS VARCHAR(255)) AS INDENT
              FROM TABL$_TB_TYPES TT2, TTT TT3 WHERE (TT2.PARENT_ID = TT3.ID)
            )SELECT T.ID AS OBJ_ID, T.NAME, T.NAME2 FROM TTT T
            )TMP
    INTO :P_OBJ_ID, :P_NAME, :P_NAME2
  DO
    BEGIN
    P_DESCR   = '  '||:P_NAME2;
    P_SUBTYPE = 0;
    P_ORDERID = 1;
    P_PATH    = 'PEAKTOP:IDE/ERP/CONFIG2/DOC/'||:P_OBJ_ID||'/RPT0000_1000054.XFM';
    UPDATE OR INSERT INTO TABL$_TB_DOCSRPT(OBJ_ID, NAME, FLAG_DELETE, ORDERID, SUBTYPE, PATH, DESCR, ACCSS)
      VALUES(:P_OBJ_ID, :P_NAME2, :P_FLAG_DELETE, :P_ORDERID, :P_SUBTYPE, :P_PATH, :P_DESCR, NULL)
      MATCHING(OBJ_ID, NAME, ORDERID, SUBTYPE, PATH)
      RETURNING ID INTO :P_ID;
    P_PATH    = 'PEAKTOP:IDE/ERP/CONFIG2/DOC/'||:P_OBJ_ID||'/RPT0000.SQL';
    UPDATE OR INSERT INTO TABL$_TB_DOCSRPTSQL(RPT_ID, NAME, PARENT, FLAG_DELETE, ORDERID, PATH)
      VALUES (:P_ID, 'qrDoc', '', 0, 0, :P_PATH)
      MATCHING(RPT_ID, NAME, PARENT, ORDERID, PATH);
    P_PATH    = 'PEAKTOP:IDE/ERP/CONFIG2/DOC/'||:P_OBJ_ID||'/RPT0000J.SQL';
    UPDATE OR INSERT INTO TABL$_TB_DOCSRPTSQL(RPT_ID, NAME, PARENT, FLAG_DELETE, ORDERID, PATH)
      VALUES (:P_ID, 'qrJrnl', 'qrDoc', 0, 1, :P_PATH)
      MATCHING(RPT_ID, NAME, PARENT, ORDERID, PATH);
    P_PATH    = 'PEAKTOP:IDE/ERP/CONFIG2/DOC/4/RPT_DEFAULT02.SQL';
    UPDATE OR INSERT INTO TABL$_TB_DOCSRPTSQL(RPT_ID, NAME, PARENT, FLAG_DELETE, ORDERID, PATH)
      VALUES (:P_ID, 'qrEnt', 'qrDoc', 0, 2, :P_PATH)
      MATCHING(RPT_ID, NAME, PARENT, ORDERID, PATH);
    -- UKRAINIAN
    P_ORDERID = 2;
    P_DESCR   = '  '||:P_NAME2||ASCII_CHAR(13)||ASCII_CHAR(10)||'  Шаблон на украинском языке';
    P_PATH    = 'PEAKTOP:IDE/ERP/CONFIG2/DOC/'||:P_OBJ_ID||'/RPT0000_1000071.XFM';
    UPDATE OR INSERT INTO TABL$_TB_DOCSRPT(OBJ_ID, NAME, FLAG_DELETE, ORDERID, SUBTYPE, PATH, DESCR, ACCSS)
      VALUES(:P_OBJ_ID, :P_NAME2||' (украинский)', :P_FLAG_DELETE, :P_ORDERID, :P_SUBTYPE, :P_PATH, :P_DESCR, NULL)
      MATCHING(OBJ_ID, NAME, ORDERID, SUBTYPE, PATH)
      RETURNING ID INTO :P_ID;
    P_PATH    = 'PEAKTOP:IDE/ERP/CONFIG2/DOC/'||:P_OBJ_ID||'/RPT0000.SQL';
    UPDATE OR INSERT INTO TABL$_TB_DOCSRPTSQL(RPT_ID, NAME, PARENT, FLAG_DELETE, ORDERID, PATH)
      VALUES (:P_ID, 'qrDoc', '', 0, 0, :P_PATH)
      MATCHING(RPT_ID, NAME, PARENT, ORDERID, PATH);
    P_PATH    = 'PEAKTOP:IDE/ERP/CONFIG2/DOC/'||:P_OBJ_ID||'/RPT0000J.SQL';
    UPDATE OR INSERT INTO TABL$_TB_DOCSRPTSQL(RPT_ID, NAME, PARENT, FLAG_DELETE, ORDERID, PATH)
      VALUES (:P_ID, 'qrJrnl', 'qrDoc', 0, 1, :P_PATH)
      MATCHING(RPT_ID, NAME, PARENT, ORDERID, PATH);
    P_PATH    = 'PEAKTOP:IDE/ERP/CONFIG2/DOC/4/RPT_DEFAULT02.SQL';
    UPDATE OR INSERT INTO TABL$_TB_DOCSRPTSQL(RPT_ID, NAME, PARENT, FLAG_DELETE, ORDERID, PATH)
      VALUES (:P_ID, 'qrEnt', 'qrDoc', 0, 2, :P_PATH)
      MATCHING(RPT_ID, NAME, PARENT, ORDERID, PATH);
    -- JOURNAL
    P_DESCR   = '  '||:P_NAME;
    P_SUBTYPE = 1;
    P_ORDERID = 1;
    P_PATH    = 'PEAKTOP:IDE/ERP/CONFIG2/DOC/'||:P_OBJ_ID||'/RPTJRNL0000_1000054.XFM';
    UPDATE OR INSERT INTO TABL$_TB_DOCSRPT(OBJ_ID, NAME, FLAG_DELETE, ORDERID, SUBTYPE, PATH, DESCR, ACCSS)
      VALUES(:P_OBJ_ID, :P_NAME, :P_FLAG_DELETE, :P_ORDERID, :P_SUBTYPE, :P_PATH, :P_DESCR, NULL)
      MATCHING(OBJ_ID, NAME, ORDERID, SUBTYPE, PATH)
      RETURNING ID INTO :P_ID;
    UPDATE OR INSERT INTO TABL$_TB_DOCSRPTSQL(RPT_ID, NAME, PARENT, FLAG_DELETE, ORDERID, PATH)
      VALUES (:P_ID, 'qrMain', '', 0, 0, 'CURRENT_QUERY')
      MATCHING(RPT_ID, NAME, PARENT, ORDERID, PATH);
    END
END


