EXECUTE BLOCK(
   Q_GENR_NAME      TYPE OF COLUMN TABL$R_FIRMS.NAME            = ?GENR_NAME
  ,Q_GENR_VALUE     TYPE OF COLUMN TABL$R_FIRMS.ID              = ?GENR_VALUE
  ,Q_TYPE_ID        TYPE OF COLUMN TABL$_TB_TYPES.ID            = ?TYPE_ID
  ,Q_NUM_PREFIX     TYPE OF COLUMN TABL$_TB_DOCS.NUM_PREFIX     = ?NUM_PREFIX
  ,Q_COLOR_FRG      TYPE OF COLUMN TABL$_TB_DOCS.COLOR_FRG      = ?COLOR_FRG
  ,Q_COLOR_BGR      TYPE OF COLUMN TABL$_TB_DOCS.COLOR_BGR      = ?COLOR_BGR
  ,Q_COLOR_FRG_HTML TYPE OF COLUMN TABL$_TB_DOCS.COLOR_FRG_HTML = ?COLOR_FRG_HTML
  ,Q_COLOR_BGR_HTML TYPE OF COLUMN TABL$_TB_DOCS.COLOR_BGR_HTML = ?COLOR_BGR_HTML
)AS
  DECLARE VARIABLE P_SQL TYPE OF COLUMN TABL$R_FIRMS.NAME;
BEGIN
  IF(EXISTS(
    SELECT G.RDB$GENERATOR_ID
    FROM   RDB$GENERATORS G
    WHERE  (TRIM(G.RDB$GENERATOR_NAME) = :Q_GENR_NAME)
  ))THEN
    BEGIN
    P_SQL = 'ALTER SEQUENCE '||:Q_GENR_NAME||' RESTART WITH '||:Q_GENR_VALUE||' ;';
    EXECUTE STATEMENT :P_SQL;
    END
  UPDATE TABL$_TB_DOCS SET 
     NUM_PREFIX     = :Q_NUM_PREFIX
    ,COLOR_FRG      = :Q_COLOR_FRG
    ,COLOR_BGR      = :Q_COLOR_BGR
    ,COLOR_FRG_HTML = :Q_COLOR_FRG_HTML
    ,COLOR_BGR_HTML = :Q_COLOR_BGR_HTML
  WHERE(TYPE_ID = :Q_TYPE_ID);    
END
