EXECUTE BLOCK(
   Q_OBJ_ID       TYPE OF COLUMN TABL$_TB.ID           = ?OBJ_ID
  ,Q_OBJ_TYPE     TYPE OF COLUMN TABL$_TB.BASE_TYPE_ID = ?OBJ_TYPE
)RETURNS (
   OBJ_ID          TYPE OF COLUMN TABL$_TB.ID
  ,OBJ_TYPE        TYPE OF COLUMN TABL$_TB.BASE_TYPE_ID
  ,IMG_INDX        TYPE OF COLUMN TABL$_TB_COLS.COL_INDEX
  ,TB_ID           TYPE OF COLUMN TABL$_TB_COLS.TB_ID
  ,ID              TYPE OF COLUMN TABL$_TB_COLS.ID
  ,NAME            TYPE OF COLUMN TABL$_TB_COLS.NAME
  ,HINT            TYPE OF COLUMN TABL$_TB_COLS.HINT
  ,FLAG_DELETE     TYPE OF COLUMN TABL$_TB_COLS.FLAG_DELETE
  ,FIELD_TYPE      TYPE OF COLUMN TABL$_TB_COLS.FIELD_TYPE
  ,ALIGNMENT       TYPE OF COLUMN TABL$_TB_COLS.ALIGNMENT
  ,FORMAT          TYPE OF COLUMN TABL$_TB_COLS.FORMAT
  ,WIDTH           TYPE OF COLUMN TABL$_TB_COLS.WIDTH
  ,COLOR           TYPE OF COLUMN TABL$_TB_COLS.COLOR
  ,COL_INDEX       TYPE OF COLUMN TABL$_TB_COLS.COL_INDEX
  ,ROW_INDEX       TYPE OF COLUMN TABL$_TB_COLS.ROW_INDEX
  ,ORIENTATION     TYPE OF COLUMN TABL$_TB_COLS.ORIENTATION
  ,PICK_LIST       TYPE OF COLUMN TABL$_TB_COLS.PICK_LIST
  ,KEY_LIST        TYPE OF COLUMN TABL$_TB_COLS.KEY_LIST
  ,DEFAULT_VALUE   TYPE OF COLUMN TABL$_TB_COLS.DEFAULT_VALUE
  ,CALC_SQL        TYPE OF COLUMN TABL$_TB_COLS.CALC_SQL
  ,EDT_LEFT        TYPE OF COLUMN TABL$_TB_COLS.EDT_LEFT
  ,EDT_TOP         TYPE OF COLUMN TABL$_TB_COLS.EDT_TOP
  ,SUBKONTO_FIELD  TYPE OF COLUMN TABL$_TB_COLS.SUBKONTO_FIELD
  ,REF_TABLE       TYPE OF COLUMN TABL$_TB_COLS.REF_TABLE
  ,REF_FIELD       TYPE OF COLUMN TABL$_TB_COLS.REF_FIELD
  ,REF_KEYFIELD    TYPE OF COLUMN TABL$_TB_COLS.REF_KEYFIELD
  ,REF_WHERE       TYPE OF COLUMN TABL$_TB_COLS.REF_WHERE
  ,REF_WHEREEDIT   TYPE OF COLUMN TABL$_TB_COLS.REF_WHEREEDIT
  ,FLAG_FOOTER     TYPE OF COLUMN TABL$_TB_COLS.FLAG_FOOTER
  ,FOOTER_COUNT    TYPE OF COLUMN TABL$_TB_COLS.COL_INDEX
  ,FLAG_ADDITIONAL TYPE OF COLUMN TABL$_TB_COLS.FLAG_ADDITIONAL
  ,FLAG_PERIODICAL TYPE OF COLUMN TABL$_TB_COLS.FLAG_PERIODICAL
  ,FLAG_UPDNULL    TYPE OF COLUMN TABL$_TB_COLS.FLAG_UPDNULL
  ,EMPTY_VALUE     TYPE OF COLUMN TABL$_TB_COLS.EMPTY_VALUE
  ,FLAG_UPDDEFAULT TYPE OF COLUMN TABL$_TB_COLS.FLAG_UPDDEFAULT
)AS
BEGIN 
  OBJ_ID   = :Q_OBJ_ID;
  OBJ_TYPE = :Q_OBJ_TYPE;
  TB_ID    = :Q_OBJ_ID;
  FOR
    SELECT  TC.ID, TC.NAME, TC.HINT, TC.FLAG_DELETE, TC.FIELD_TYPE, TC.ALIGNMENT
           ,TC.FORMAT, TC.WIDTH, TC.COL_INDEX, TC.ROW_INDEX, TC.ORIENTATION
           ,TC.PICK_LIST, TC.KEY_LIST, TC.CALC_SQL, TC.REF_TABLE, TC.REF_FIELD
           ,TC.REF_KEYFIELD, TC.REF_WHERE, TC.REF_WHEREEDIT,TC.FLAG_FOOTER
           ,TC.FLAG_ADDITIONAL, TC.FLAG_PERIODICAL, TC.DEFAULT_VALUE
           ,TC.EDT_LEFT, TC.EDT_TOP, TC.COLOR, TC.FLAG_UPDNULL, TC.EMPTY_VALUE, TC.FLAG_UPDDEFAULT
           ,TC.SUBKONTO_FIELD
    FROM   TABL$_TB_COLS TC 
    WHERE  (TC.TB_ID = :TB_ID) 
    ORDER BY TC.COL_INDEX, TC.ROW_INDEX 
    INTO    :ID, :NAME, :HINT, :FLAG_DELETE, :FIELD_TYPE, :ALIGNMENT, :FORMAT
           ,:WIDTH, :COL_INDEX, :ROW_INDEX, :ORIENTATION, :PICK_LIST, :KEY_LIST
           ,:CALC_SQL, :REF_TABLE, :REF_FIELD, :REF_KEYFIELD, :REF_WHERE, :REF_WHEREEDIT
           ,:FLAG_FOOTER, :FLAG_ADDITIONAL, :FLAG_PERIODICAL, :DEFAULT_VALUE
           ,:EDT_LEFT, :EDT_TOP, :COLOR, :FLAG_UPDNULL, :EMPTY_VALUE, :FLAG_UPDDEFAULT
           ,:SUBKONTO_FIELD 
  DO 
    BEGIN 
    IMG_INDX = 0;
         IF(TRIM(:CALC_SQL )<> '')THEN IMG_INDX = 1;
    ELSE IF(:FLAG_PERIODICAL = 1 )THEN IMG_INDX = 2;
    ELSE IF(:FIELD_TYPE STARTING WITH 'DOMN$BLOB')THEN IMG_INDX = 3;
    ELSE IF(:FLAG_DELETE     = 1 )THEN IMG_INDX = 4;
    ELSE IF(TRIM(:KEY_LIST )<> '')THEN IMG_INDX = 5;
    ELSE IF( (TRIM(:REF_TABLE)<> '') OR (TRIM(:SUBKONTO_FIELD)<> '') )THEN IMG_INDX = 6;
    FOOTER_COUNT    = 0;
    IF(:FLAG_FOOTER <> 0)THEN
      BEGIN
      SELECT COUNT(TF.ID)
      FROM   TABL$_TB_COLS_FOOTERS TF
      WHERE  (TF.TB_ID = :TB_ID)
        AND  (TF.TC_ID = :ID ) 
      INTO  :FOOTER_COUNT;
      END   
    SUSPEND;
    END 
END
