{$DEFINE PEAKTOP:OBJ/CUSTOMDIALOGDB01.INC}
  //============================================================================
  function CreateCustomDialogDB01(const aCaption, aCaptionTopPanel :string; 
             const aWidth, aHeight :Integer
             ):TForm;
  var
    lkTopPanel    :TxcGradientPanelVista;
    lkBottomPanel :TxcGradientPanel;
    lkBtnCancel   :TxcButton; 
    lkBtnOK       :TxcButton; 
    lkTr          :TxFBTransaction;
    lkDts         :TxFBDataSet;
    lkDS          :TDataSource;
    lkdbg         :TDBGridEh;
  begin
    Result             := TForm.Create(nil);
    Result.BorderStyle := bsDialog;
    Result.Caption     := aCaption;
    Result.Color       := Amunhotep.MainForm.StyleManager.Colors.Foreground;
    Result.Font.Name   := 'Verdana';
    Result.Font.Size   := 7;
    Result.Font.Color  := Amunhotep.MainForm.StyleManager.Colors.Border;
    Result.Position    := poDesktopCenter;
    Result.Width       := aWidth;
    Result.Height      := aHeight;
    lkTopPanel              := TxcGradientPanelVista.Create(Result);
    lkTopPanel.Name         := 'TopPanel';
    lkTopPanel.Caption      := aCaptionTopPanel;
    lkTopPanel.Parent       := Result;
    lkTopPanel.Left         := 0;
    lkTopPanel.Top          := 0;
    lkTopPanel.Height       := 32;
    lkTopPanel.Align        := alTop;
    lkTopPanel.BorderStyle  := xbsRaized;
    lkTopPanel.StyleManager := Amunhotep.MainForm.StyleManager;
    lkTopPanel.Font.Name    := 'Verdana';
    lkTopPanel.Font.Size    := 12;
    lkTopPanel.Font.Style   := [fsBold];
    lkTopPanel.Font.Color   := Amunhotep.MainForm.StyleManager.Colors.Window;
    lkBottomPanel                := TxcGradientPanel.Create(Result);
    lkBottomPanel.Name           := 'BottomPanel';
    lkBottomPanel.Parent         := Result;
    lkBottomPanel.Height         := 20;
    lkBottomPanel.Left           := 0;
    lkBottomPanel.Top            := Result.Height - lkBottomPanel.Height;
    lkBottomPanel.Align          := alBottom;
    lkBottomPanel.BorderStyle    := xbsNone;
    lkBottomPanel.GradientDirect := gdLeftToRight;
    lkBottomPanel.StyleManager   := Amunhotep.MainForm.StyleManager;
    lkBottomPanel.Font.Style     := [fsBold];
    lkBtnCancel                := TxcButton.Create(Result);
    lkBtnCancel.Parent         := lkBottomPanel;
    lkBtnCancel.Top            := 0;
    lkBtnCancel.Width          := 96;
    lkBtnCancel.Left           := lkBottomPanel.Width - lkBtnCancel.Width;
    lkBtnCancel.Align          := alRight;
    lkBtnCancel.StyleManager   := Amunhotep.MainForm.StyleManager;
    lkBtnCancel.Cancel         := true;
    lkBtnCancel.Caption        := 'Отмена';
    lkBtnCancel.ModalResult    := mrCancel;  
    lkBtnOK                    := TxcButton.Create(Result);
    lkBtnOK.Parent             := lkBottomPanel;
    lkBtnOK.Top                := 0;
    lkBtnOK.Width              := 96;
    lkBtnOK.Left               := lkBottomPanel.Width - lkBtnCancel.Width - lkBtnOK.Width;
    lkBtnOK.Align              := alRight;
    lkBtnOK.StyleManager       := Amunhotep.MainForm.StyleManager;
    lkBtnOK.Default            := true;
    lkBtnOK.Caption            := 'OK';
    lkBtnOK.ModalResult        := mrOk;  
    lkTr                    := TxFBTransaction.Create(Result);
    lkTr.Name               := 'Transaction';
    lkTr.DefaultDataBase    := FBDataBase;
    lkDts                   := TxFBDataSet.Create(Result);
    lkDts.Name              := 'DataSet';
    lkDts.Transaction       := lkTr;
    lkDS                    := TDataSource.Create(Result);
    lkDS.Name               := 'DataSource';
    lkDS.DataSet            := lkDts;
    lkdbg                   := TDBGridEh.Create(Result);
    lkdbg.Name              := 'DBGridEh';
    lkdbg.Parent            := Result;
    lkdbg.Align             := alClient;
    lkdbg.Color             := Amunhotep.MainForm.StyleManager.Colors.Window;
    lkdbg.Font.Color        := Amunhotep.MainForm.StyleManager.Colors.Border;
    lkdbg.FixedColor        := Amunhotep.MainForm.StyleManager.Colors.Foreground;
    lkdbg.TitleFont.Color   := Amunhotep.MainForm.StyleManager.Colors.Border;
    lkdbg.TitleFont.Style   := [fsBold];
    lkdbg.UseMultiTitle     := true;
    lkdbg.VTitleMargin      := 4;
    lkdbg.Ctl3D             := false;
    lkdbg.Flat              := true;
    lkdbg.DataSource        := lkDS;
    lkdbg.AllowedOperations := [];
    lkdbg.OptionsEh         := lkdbg.OptionsEh + [dghRowHighlight];
    lkdbg.Columns.Clear;
    Result.ActiveControl    := lkDBG;
  end;
